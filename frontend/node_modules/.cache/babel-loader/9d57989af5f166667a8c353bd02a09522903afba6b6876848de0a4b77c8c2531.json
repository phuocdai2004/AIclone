{"ast":null,"code":"var _jsxFileName = \"D:\\\\IZ\\\\AIClone\\\\frontend\\\\src\\\\Avatar3D.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport * as THREE from 'three';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Avatar3D = () => {\n  _s();\n  const mountRef = useRef(null);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const sceneRef = useRef(null);\n  const rendererRef = useRef(null);\n  const headRef = useRef(null);\n  const mouthRef = useRef(null);\n  const leftEyeRef = useRef(null);\n  const rightEyeRef = useRef(null);\n  const leftBrowRef = useRef(null);\n  const rightBrowRef = useRef(null);\n  const faceTextureRef = useRef(null);\n  const [mode, setMode] = useState('setup'); // setup, scanning, avatar\n  const [message, setMessage] = useState('');\n  const [isListening, setIsListening] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [faceData, setFaceData] = useState(null);\n  const [scanProgress, setScanProgress] = useState(0);\n  const [expression, setExpression] = useState('neutral'); // neutral, happy, sad, angry, surprised\n  const [chatHistory, setChatHistory] = useState([]);\n  const [avatarConfig, setAvatarConfig] = useState({\n    skinColor: '#F5C6A5',\n    eyeColor: '#4A3728',\n    hairColor: '#2C1810',\n    lipColor: '#C4756E',\n    faceTexture: null,\n    faceShape: 'oval',\n    // oval, round, square, heart\n    eyeSize: 1,\n    noseSize: 1,\n    mouthSize: 1\n  });\n\n  // Start webcam for face scanning\n  const startWebcam = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: 640,\n          height: 480,\n          facingMode: 'user'\n        }\n      });\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        videoRef.current.play();\n      }\n      setMode('scanning');\n    } catch (error) {\n      console.error('Webcam error:', error);\n      alert('âŒ KhÃ´ng thá»ƒ truy cáº­p camera. Vui lÃ²ng cho phÃ©p quyá»n truy cáº­p.');\n    }\n  };\n\n  // Capture face from webcam\n  const captureFace = useCallback(() => {\n    if (!videoRef.current || !canvasRef.current) return null;\n    const canvas = canvasRef.current;\n    const video = videoRef.current;\n    const ctx = canvas.getContext('2d');\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n\n    // Flip horizontally for mirror effect\n    ctx.translate(canvas.width, 0);\n    ctx.scale(-1, 1);\n    ctx.drawImage(video, 0, 0);\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    return canvas.toDataURL('image/jpeg', 0.9);\n  }, []);\n\n  // Analyze face colors and features\n  const analyzeFace = useCallback(imageData => {\n    return new Promise(resolve => {\n      const img = new Image();\n      img.onload = () => {\n        const canvas = document.createElement('canvas');\n        canvas.width = img.width;\n        canvas.height = img.height;\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(img, 0, 0);\n\n        // Sample skin color from forehead area\n        const foreheadData = ctx.getImageData(img.width * 0.4, img.height * 0.15, img.width * 0.2, img.height * 0.1);\n\n        // Sample eye color\n        const leftEyeData = ctx.getImageData(img.width * 0.3, img.height * 0.35, img.width * 0.1, img.height * 0.05);\n\n        // Sample hair color from top\n        const hairData = ctx.getImageData(img.width * 0.3, img.height * 0.02, img.width * 0.4, img.height * 0.08);\n\n        // Sample lip color\n        const lipData = ctx.getImageData(img.width * 0.4, img.height * 0.65, img.width * 0.2, img.height * 0.08);\n        const getAvgColor = data => {\n          let r = 0,\n            g = 0,\n            b = 0;\n          for (let i = 0; i < data.data.length; i += 4) {\n            r += data.data[i];\n            g += data.data[i + 1];\n            b += data.data[i + 2];\n          }\n          const count = data.data.length / 4;\n          return `rgb(${Math.round(r / count)},${Math.round(g / count)},${Math.round(b / count)})`;\n        };\n        resolve({\n          skinColor: getAvgColor(foreheadData),\n          eyeColor: getAvgColor(leftEyeData),\n          hairColor: getAvgColor(hairData),\n          lipColor: getAvgColor(lipData),\n          faceTexture: imageData\n        });\n      };\n      img.src = imageData;\n    });\n  }, []);\n\n  // Scan face with progress\n  const scanFace = async () => {\n    setScanProgress(0);\n    const captures = [];\n\n    // Capture multiple frames for better analysis\n    for (let i = 0; i < 5; i++) {\n      await new Promise(r => setTimeout(r, 500));\n      const capture = captureFace();\n      if (capture) captures.push(capture);\n      setScanProgress((i + 1) * 20);\n    }\n    if (captures.length > 0) {\n      var _videoRef$current;\n      // Use the best capture (middle one)\n      const bestCapture = captures[Math.floor(captures.length / 2)];\n      const analysis = await analyzeFace(bestCapture);\n      setFaceData(analysis);\n      setAvatarConfig(prev => ({\n        ...prev,\n        ...analysis\n      }));\n\n      // Stop webcam\n      if ((_videoRef$current = videoRef.current) !== null && _videoRef$current !== void 0 && _videoRef$current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\n      }\n      setScanProgress(100);\n      setTimeout(() => setMode('avatar'), 1000);\n    }\n  };\n\n  // Initialize 3D Avatar\n  useEffect(() => {\n    if (mode !== 'avatar' || !mountRef.current) return;\n\n    // Scene\n    const scene = new THREE.Scene();\n    scene.background = new THREE.Color(0x1a1a2e);\n    sceneRef.current = scene;\n\n    // Camera\n    const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);\n    camera.position.z = 4;\n\n    // Renderer\n    const renderer = new THREE.WebGLRenderer({\n      antialias: true\n    });\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    renderer.shadowMap.enabled = true;\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n    mountRef.current.appendChild(renderer.domElement);\n    rendererRef.current = renderer;\n\n    // Lighting\n    const keyLight = new THREE.DirectionalLight(0xffffff, 1.2);\n    keyLight.position.set(2, 3, 4);\n    keyLight.castShadow = true;\n    scene.add(keyLight);\n    const fillLight = new THREE.DirectionalLight(0xffffff, 0.4);\n    fillLight.position.set(-2, 1, 2);\n    scene.add(fillLight);\n    const rimLight = new THREE.DirectionalLight(0xff9a56, 0.3);\n    rimLight.position.set(0, 2, -3);\n    scene.add(rimLight);\n    const ambient = new THREE.AmbientLight(0xffffff, 0.5);\n    scene.add(ambient);\n\n    // Create realistic head\n    const headGroup = new THREE.Group();\n    scene.add(headGroup);\n    headRef.current = headGroup;\n\n    // Head base (ellipsoid)\n    const headGeo = new THREE.SphereGeometry(1, 64, 64);\n    const headMat = new THREE.MeshStandardMaterial({\n      color: avatarConfig.skinColor,\n      roughness: 0.4,\n      metalness: 0.05\n    });\n\n    // Apply face texture if available\n    if (avatarConfig.faceTexture) {\n      const textureLoader = new THREE.TextureLoader();\n      const faceTexture = textureLoader.load(avatarConfig.faceTexture);\n      headMat.map = faceTexture;\n      faceTextureRef.current = faceTexture;\n    }\n    const head = new THREE.Mesh(headGeo, headMat);\n    head.scale.set(1, 1.15, 0.95);\n    head.castShadow = true;\n    headGroup.add(head);\n\n    // Hair\n    const hairGeo = new THREE.SphereGeometry(1.12, 64, 64, 0, Math.PI * 2, 0, Math.PI * 0.55);\n    const hairMat = new THREE.MeshStandardMaterial({\n      color: avatarConfig.hairColor,\n      roughness: 0.7\n    });\n    const hair = new THREE.Mesh(hairGeo, hairMat);\n    hair.position.y = 0.35;\n    hair.scale.set(1, 1.1, 0.95);\n    headGroup.add(hair);\n\n    // Eyes with realistic structure\n    const createEye = x => {\n      const eyeGroup = new THREE.Group();\n\n      // Eye socket (slight indent)\n      const socketGeo = new THREE.SphereGeometry(0.22, 32, 32);\n      const socketMat = new THREE.MeshStandardMaterial({\n        color: '#E8D4C4',\n        roughness: 0.5\n      });\n      const socket = new THREE.Mesh(socketGeo, socketMat);\n      socket.position.z = -0.02;\n      eyeGroup.add(socket);\n\n      // Eyeball (white)\n      const eyeballGeo = new THREE.SphereGeometry(0.18, 32, 32);\n      const eyeballMat = new THREE.MeshStandardMaterial({\n        color: 0xffffff,\n        roughness: 0.1\n      });\n      const eyeball = new THREE.Mesh(eyeballGeo, eyeballMat);\n      eyeGroup.add(eyeball);\n\n      // Iris\n      const irisGeo = new THREE.CircleGeometry(0.1, 32);\n      const irisMat = new THREE.MeshStandardMaterial({\n        color: avatarConfig.eyeColor,\n        roughness: 0.3\n      });\n      const iris = new THREE.Mesh(irisGeo, irisMat);\n      iris.position.z = 0.16;\n      eyeGroup.add(iris);\n\n      // Pupil\n      const pupilGeo = new THREE.CircleGeometry(0.04, 32);\n      const pupilMat = new THREE.MeshStandardMaterial({\n        color: 0x000000\n      });\n      const pupil = new THREE.Mesh(pupilGeo, pupilMat);\n      pupil.position.z = 0.17;\n      eyeGroup.add(pupil);\n\n      // Eye highlight\n      const highlightGeo = new THREE.CircleGeometry(0.02, 16);\n      const highlightMat = new THREE.MeshBasicMaterial({\n        color: 0xffffff\n      });\n      const highlight = new THREE.Mesh(highlightGeo, highlightMat);\n      highlight.position.set(0.03, 0.03, 0.18);\n      eyeGroup.add(highlight);\n      eyeGroup.position.set(x, 0.25, 0.85);\n      eyeGroup.scale.setScalar(avatarConfig.eyeSize);\n      return eyeGroup;\n    };\n    const leftEye = createEye(-0.32);\n    const rightEye = createEye(0.32);\n    headGroup.add(leftEye);\n    headGroup.add(rightEye);\n    leftEyeRef.current = leftEye;\n    rightEyeRef.current = rightEye;\n\n    // Eyebrows\n    const browGeo = new THREE.BoxGeometry(0.28, 0.06, 0.08);\n    const browMat = new THREE.MeshStandardMaterial({\n      color: avatarConfig.hairColor,\n      roughness: 0.6\n    });\n    const leftBrow = new THREE.Mesh(browGeo, browMat);\n    leftBrow.position.set(-0.32, 0.48, 0.82);\n    leftBrow.rotation.z = 0.15;\n    headGroup.add(leftBrow);\n    leftBrowRef.current = leftBrow;\n    const rightBrow = new THREE.Mesh(browGeo, browMat);\n    rightBrow.position.set(0.32, 0.48, 0.82);\n    rightBrow.rotation.z = -0.15;\n    headGroup.add(rightBrow);\n    rightBrowRef.current = rightBrow;\n\n    // Nose\n    const noseGroup = new THREE.Group();\n    const noseBridgeGeo = new THREE.CylinderGeometry(0.06, 0.08, 0.35, 16);\n    const noseMat = new THREE.MeshStandardMaterial({\n      color: avatarConfig.skinColor,\n      roughness: 0.4\n    });\n    const noseBridge = new THREE.Mesh(noseBridgeGeo, noseMat);\n    noseBridge.rotation.x = Math.PI * 0.15;\n    noseGroup.add(noseBridge);\n    const noseTipGeo = new THREE.SphereGeometry(0.1, 16, 16);\n    const noseTip = new THREE.Mesh(noseTipGeo, noseMat);\n    noseTip.position.set(0, -0.12, 0.08);\n    noseGroup.add(noseTip);\n    noseGroup.position.set(0, 0.05, 0.9);\n    noseGroup.scale.setScalar(avatarConfig.noseSize);\n    headGroup.add(noseGroup);\n\n    // Mouth with lips\n    const mouthGroup = new THREE.Group();\n\n    // Upper lip\n    const upperLipGeo = new THREE.TorusGeometry(0.18, 0.04, 8, 32, Math.PI);\n    const lipMat = new THREE.MeshStandardMaterial({\n      color: avatarConfig.lipColor,\n      roughness: 0.5\n    });\n    const upperLip = new THREE.Mesh(upperLipGeo, lipMat);\n    upperLip.rotation.x = Math.PI;\n    upperLip.position.y = 0.02;\n    mouthGroup.add(upperLip);\n\n    // Lower lip\n    const lowerLipGeo = new THREE.TorusGeometry(0.16, 0.05, 8, 32, Math.PI);\n    const lowerLip = new THREE.Mesh(lowerLipGeo, lipMat);\n    lowerLip.position.y = -0.02;\n    mouthGroup.add(lowerLip);\n\n    // Mouth interior (for opening)\n    const mouthInteriorGeo = new THREE.PlaneGeometry(0.3, 0.15);\n    const mouthInteriorMat = new THREE.MeshStandardMaterial({\n      color: 0x3d1f1f,\n      side: THREE.DoubleSide\n    });\n    const mouthInterior = new THREE.Mesh(mouthInteriorGeo, mouthInteriorMat);\n    mouthInterior.position.z = -0.02;\n    mouthInterior.visible = false;\n    mouthGroup.add(mouthInterior);\n    mouthGroup.position.set(0, -0.38, 0.88);\n    mouthGroup.scale.setScalar(avatarConfig.mouthSize);\n    headGroup.add(mouthGroup);\n    mouthRef.current = mouthGroup;\n\n    // Ears\n    const earGeo = new THREE.SphereGeometry(0.15, 16, 16);\n    const earMat = new THREE.MeshStandardMaterial({\n      color: avatarConfig.skinColor,\n      roughness: 0.5\n    });\n    const leftEar = new THREE.Mesh(earGeo, earMat);\n    leftEar.position.set(-0.98, 0.15, 0);\n    leftEar.scale.set(0.5, 1, 0.6);\n    headGroup.add(leftEar);\n    const rightEar = new THREE.Mesh(earGeo, earMat);\n    rightEar.position.set(0.98, 0.15, 0);\n    rightEar.scale.set(0.5, 1, 0.6);\n    headGroup.add(rightEar);\n\n    // Neck\n    const neckGeo = new THREE.CylinderGeometry(0.35, 0.4, 0.5, 32);\n    const neckMat = new THREE.MeshStandardMaterial({\n      color: avatarConfig.skinColor,\n      roughness: 0.4\n    });\n    const neck = new THREE.Mesh(neckGeo, neckMat);\n    neck.position.y = -1.35;\n    headGroup.add(neck);\n\n    // Animation variables\n    let blinkTimer = 0;\n    let breathTimer = 0;\n    let talkTimer = 0;\n    let currentExpression = 'neutral';\n\n    // Mouse tracking\n    const onMouseMove = e => {\n      const x = e.clientX / window.innerWidth * 2 - 1;\n      const y = -(e.clientY / window.innerHeight) * 2 + 1;\n      if (headRef.current) {\n        // Smooth head rotation\n        headRef.current.rotation.y += (x * 0.4 - headRef.current.rotation.y) * 0.1;\n        headRef.current.rotation.x += (y * 0.2 - headRef.current.rotation.x) * 0.1;\n      }\n\n      // Eye follow\n      if (leftEyeRef.current && rightEyeRef.current) {\n        leftEyeRef.current.rotation.y = x * 0.3;\n        leftEyeRef.current.rotation.x = -y * 0.2;\n        rightEyeRef.current.rotation.y = x * 0.3;\n        rightEyeRef.current.rotation.x = -y * 0.2;\n      }\n    };\n    window.addEventListener('mousemove', onMouseMove);\n\n    // Animation loop\n    const animate = () => {\n      requestAnimationFrame(animate);\n\n      // Breathing animation\n      breathTimer += 0.02;\n      if (headRef.current) {\n        headRef.current.position.y = Math.sin(breathTimer) * 0.02;\n        headRef.current.scale.x = 1 + Math.sin(breathTimer) * 0.005;\n      }\n\n      // Blinking\n      blinkTimer++;\n      if (blinkTimer > 180 && blinkTimer < 190) {\n        const blinkAmount = 1 - Math.sin((blinkTimer - 180) / 10 * Math.PI);\n        if (leftEyeRef.current) leftEyeRef.current.scale.y = Math.max(0.1, blinkAmount);\n        if (rightEyeRef.current) rightEyeRef.current.scale.y = Math.max(0.1, blinkAmount);\n      } else {\n        if (leftEyeRef.current) leftEyeRef.current.scale.y = 1;\n        if (rightEyeRef.current) rightEyeRef.current.scale.y = 1;\n        if (blinkTimer > 190) blinkTimer = 0;\n      }\n\n      // Talking animation (mouth movement)\n      if (isSpeaking && mouthRef.current) {\n        talkTimer += 0.3;\n        const mouthOpen = Math.abs(Math.sin(talkTimer)) * 0.3;\n        mouthRef.current.scale.y = 1 + mouthOpen;\n        mouthRef.current.children[2].visible = mouthOpen > 0.1; // Show interior when open\n      } else {\n        if (mouthRef.current) {\n          mouthRef.current.scale.y = 1;\n          mouthRef.current.children[2].visible = false;\n        }\n      }\n\n      // Expression animations\n      if (leftBrowRef.current && rightBrowRef.current) {\n        switch (expression) {\n          case 'happy':\n            leftBrowRef.current.position.y = 0.52;\n            rightBrowRef.current.position.y = 0.52;\n            if (mouthRef.current) mouthRef.current.rotation.z = 0.1;\n            break;\n          case 'sad':\n            leftBrowRef.current.rotation.z = -0.3;\n            rightBrowRef.current.rotation.z = 0.3;\n            if (mouthRef.current) mouthRef.current.rotation.z = -0.1;\n            break;\n          case 'angry':\n            leftBrowRef.current.rotation.z = 0.4;\n            rightBrowRef.current.rotation.z = -0.4;\n            leftBrowRef.current.position.y = 0.42;\n            rightBrowRef.current.position.y = 0.42;\n            break;\n          case 'surprised':\n            leftBrowRef.current.position.y = 0.55;\n            rightBrowRef.current.position.y = 0.55;\n            if (mouthRef.current) mouthRef.current.scale.y = 1.5;\n            break;\n          default:\n            leftBrowRef.current.position.y = 0.48;\n            rightBrowRef.current.position.y = 0.48;\n            leftBrowRef.current.rotation.z = 0.15;\n            rightBrowRef.current.rotation.z = -0.15;\n        }\n      }\n      renderer.render(scene, camera);\n    };\n    animate();\n\n    // Resize handler\n    const handleResize = () => {\n      camera.aspect = window.innerWidth / window.innerHeight;\n      camera.updateProjectionMatrix();\n      renderer.setSize(window.innerWidth, window.innerHeight);\n    };\n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('mousemove', onMouseMove);\n      window.removeEventListener('resize', handleResize);\n      if (mountRef.current && renderer.domElement) {\n        mountRef.current.removeChild(renderer.domElement);\n      }\n    };\n  }, [mode, avatarConfig, isSpeaking, expression]);\n\n  // Voice recognition\n  const startListening = () => {\n    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();\n    recognition.lang = 'vi-VN';\n    recognition.continuous = false;\n    recognition.onstart = () => setIsListening(true);\n    recognition.onresult = event => {\n      const transcript = event.results[0][0].transcript;\n      setMessage(transcript);\n      setIsListening(false);\n      sendMessage(transcript);\n    };\n    recognition.onerror = () => setIsListening(false);\n    recognition.start();\n  };\n\n  // Send message to AI\n  const sendMessage = async msg => {\n    if (!msg.trim()) return;\n    setChatHistory(prev => [...prev, {\n      role: 'user',\n      content: msg\n    }]);\n    setIsSpeaking(true);\n\n    // Detect emotion from message\n    if (msg.includes('vui') || msg.includes('haha') || msg.includes('ðŸ˜Š')) {\n      setExpression('happy');\n    } else if (msg.includes('buá»“n') || msg.includes('ðŸ˜¢')) {\n      setExpression('sad');\n    } else if (msg.includes('tá»©c') || msg.includes('ðŸ˜ ')) {\n      setExpression('angry');\n    } else {\n      setExpression('neutral');\n    }\n    try {\n      const response = await axios.post('http://localhost:8000/api/chat', {\n        text: msg\n      });\n      const aiResponse = response.data.ai_response;\n      setChatHistory(prev => [...prev, {\n        role: 'ai',\n        content: aiResponse\n      }]);\n      setMessage(aiResponse);\n\n      // Text-to-speech with emotion\n      const utterance = new SpeechSynthesisUtterance(aiResponse);\n      utterance.lang = 'vi-VN';\n      utterance.rate = 1.0;\n      utterance.pitch = 1.0;\n      utterance.onend = () => {\n        setIsSpeaking(false);\n        setExpression('neutral');\n      };\n      window.speechSynthesis.speak(utterance);\n    } catch (error) {\n      console.error('Error:', error);\n      setIsSpeaking(false);\n      setExpression('neutral');\n    }\n  };\n\n  // Render based on mode\n  if (mode === 'setup') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: '100%',\n        height: '100vh',\n        background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n        color: 'white',\n        fontFamily: \"'Segoe UI', sans-serif\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: 'center',\n          padding: '40px',\n          background: 'rgba(255,255,255,0.1)',\n          borderRadius: '20px',\n          backdropFilter: 'blur(10px)',\n          maxWidth: '500px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          style: {\n            fontSize: '2.5rem',\n            marginBottom: '20px'\n          },\n          children: \"\\uD83C\\uDFAD AI Clone Creator\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 609,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '1.2rem',\n            opacity: 0.8,\n            marginBottom: '30px'\n          },\n          children: \"T\\u1EA1o nh\\xE2n b\\u1EA3n AI c\\u1EE7a ch\\xEDnh b\\u1EA1n v\\u1EDBi khu\\xF4n m\\u1EB7t, gi\\u1ECDng n\\xF3i v\\xE0 t\\xEDnh c\\xE1ch gi\\u1ED1ng h\\u1EC7t b\\u1EA1n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 612,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '30px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '15px',\n              justifyContent: 'center',\n              flexWrap: 'wrap'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                padding: '15px',\n                background: 'rgba(255,154,86,0.2)',\n                borderRadius: '10px'\n              },\n              children: \"\\uD83D\\uDCF8 Qu\\xE9t khu\\xF4n m\\u1EB7t\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 618,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                padding: '15px',\n                background: 'rgba(255,154,86,0.2)',\n                borderRadius: '10px'\n              },\n              children: \"\\uD83C\\uDFA8 T\\u1EA1o 3D Avatar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 621,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                padding: '15px',\n                background: 'rgba(255,154,86,0.2)',\n                borderRadius: '10px'\n              },\n              children: \"\\uD83D\\uDDE3\\uFE0F N\\xF3i chuy\\u1EC7n AI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 624,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 617,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 616,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startWebcam,\n          style: {\n            padding: '15px 40px',\n            fontSize: '1.2rem',\n            background: 'linear-gradient(135deg, #ff9a56 0%, #ff7043 100%)',\n            color: 'white',\n            border: 'none',\n            borderRadius: '30px',\n            cursor: 'pointer',\n            fontWeight: 'bold',\n            transition: 'transform 0.2s, box-shadow 0.2s'\n          },\n          onMouseOver: e => {\n            e.target.style.transform = 'scale(1.05)';\n            e.target.style.boxShadow = '0 10px 30px rgba(255,112,67,0.4)';\n          },\n          onMouseOut: e => {\n            e.target.style.transform = 'scale(1)';\n            e.target.style.boxShadow = 'none';\n          },\n          children: \"\\uD83D\\uDE80 B\\u1EAFt \\u0111\\u1EA7u t\\u1EA1o Clone\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 630,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 601,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 590,\n      columnNumber: 7\n    }, this);\n  }\n  if (mode === 'scanning') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: '100%',\n        height: '100vh',\n        background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n        color: 'white'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          marginBottom: '20px'\n        },\n        children: \"\\uD83D\\uDCF8 Qu\\xE9t khu\\xF4n m\\u1EB7t c\\u1EE7a b\\u1EA1n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 671,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'relative',\n          borderRadius: '20px',\n          overflow: 'hidden',\n          boxShadow: '0 20px 60px rgba(0,0,0,0.5)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          style: {\n            width: '640px',\n            maxWidth: '90vw',\n            transform: 'scaleX(-1)',\n            borderRadius: '20px'\n          },\n          autoPlay: true,\n          playsInline: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 679,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'absolute',\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            width: '250px',\n            height: '320px',\n            border: '3px dashed rgba(255,154,86,0.8)',\n            borderRadius: '50%',\n            pointerEvents: 'none'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 692,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          style: {\n            display: 'none'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 704,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 673,\n        columnNumber: 9\n      }, this), scanProgress > 0 && scanProgress < 100 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '20px',\n          width: '300px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            height: '10px',\n            background: 'rgba(255,255,255,0.2)',\n            borderRadius: '5px',\n            overflow: 'hidden'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              height: '100%',\n              width: `${scanProgress}%`,\n              background: 'linear-gradient(90deg, #ff9a56, #ff7043)',\n              transition: 'width 0.3s'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 715,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 709,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: 'center',\n            marginTop: '10px'\n          },\n          children: [\"\\u0110ang qu\\xE9t... \", scanProgress, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 722,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 708,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '30px',\n          display: 'flex',\n          gap: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: scanFace,\n          disabled: scanProgress > 0 && scanProgress < 100,\n          style: {\n            padding: '15px 30px',\n            fontSize: '1rem',\n            background: scanProgress > 0 ? '#ccc' : 'linear-gradient(135deg, #ff9a56 0%, #ff7043 100%)',\n            color: 'white',\n            border: 'none',\n            borderRadius: '25px',\n            cursor: scanProgress > 0 ? 'not-allowed' : 'pointer',\n            fontWeight: 'bold'\n          },\n          children: scanProgress === 100 ? 'âœ… HoÃ n thÃ nh!' : 'ðŸ“· Chá»¥p & QuÃ©t'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 729,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setMode('avatar'),\n          style: {\n            padding: '15px 30px',\n            fontSize: '1rem',\n            background: 'rgba(255,255,255,0.2)',\n            color: 'white',\n            border: '2px solid rgba(255,255,255,0.3)',\n            borderRadius: '25px',\n            cursor: 'pointer'\n          },\n          children: \"B\\u1ECF qua \\u2192\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 746,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 728,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 661,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Avatar mode\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: '100%',\n      height: '100vh',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mountRef,\n      style: {\n        width: '100%',\n        height: '100%'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 768,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        bottom: 20,\n        left: 20,\n        width: '380px',\n        maxHeight: '60vh',\n        background: 'rgba(26,26,46,0.95)',\n        borderRadius: '20px',\n        padding: '20px',\n        color: 'white',\n        backdropFilter: 'blur(10px)',\n        boxShadow: '0 10px 40px rgba(0,0,0,0.3)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          color: '#ff9a56',\n          marginBottom: '15px',\n          display: 'flex',\n          alignItems: 'center',\n          gap: '10px'\n        },\n        children: [\"\\uD83C\\uDFAD AI Clone c\\u1EE7a b\\u1EA1n\", isSpeaking && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            fontSize: '12px',\n            color: '#4ECDC4'\n          },\n          children: \"\\uD83D\\uDD0A \\u0110ang n\\xF3i...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 792,\n          columnNumber: 26\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 784,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          maxHeight: '200px',\n          overflowY: 'auto',\n          marginBottom: '15px',\n          padding: '10px',\n          background: 'rgba(255,255,255,0.05)',\n          borderRadius: '10px'\n        },\n        children: chatHistory.map((chat, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '10px',\n            textAlign: chat.role === 'user' ? 'right' : 'left'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              display: 'inline-block',\n              padding: '8px 12px',\n              borderRadius: '15px',\n              background: chat.role === 'user' ? '#ff7043' : 'rgba(255,255,255,0.1)',\n              maxWidth: '80%',\n              fontSize: '14px'\n            },\n            children: chat.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 809,\n            columnNumber: 15\n          }, this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 805,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 796,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '10px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          onKeyPress: e => e.key === 'Enter' && sendMessage(message),\n          placeholder: \"N\\xF3i chuy\\u1EC7n v\\u1EDBi clone c\\u1EE7a b\\u1EA1n...\",\n          style: {\n            flex: 1,\n            padding: '12px',\n            borderRadius: '25px',\n            border: 'none',\n            background: 'rgba(255,255,255,0.1)',\n            color: 'white',\n            outline: 'none'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 825,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startListening,\n          disabled: isListening || isSpeaking,\n          style: {\n            width: '45px',\n            height: '45px',\n            borderRadius: '50%',\n            border: 'none',\n            background: isListening ? '#FF6B6B' : '#4ECDC4',\n            color: 'white',\n            cursor: 'pointer',\n            fontSize: '18px'\n          },\n          children: \"\\uD83C\\uDFA4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 841,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => sendMessage(message),\n          disabled: isSpeaking,\n          style: {\n            width: '45px',\n            height: '45px',\n            borderRadius: '50%',\n            border: 'none',\n            background: '#ff7043',\n            color: 'white',\n            cursor: 'pointer',\n            fontSize: '18px'\n          },\n          children: \"\\uD83D\\uDCAC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 857,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 824,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '15px',\n          display: 'flex',\n          gap: '8px',\n          justifyContent: 'center'\n        },\n        children: ['neutral', 'happy', 'sad', 'angry', 'surprised'].map(exp => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setExpression(exp),\n          style: {\n            padding: '8px 12px',\n            borderRadius: '15px',\n            border: expression === exp ? '2px solid #ff7043' : '2px solid transparent',\n            background: 'rgba(255,255,255,0.1)',\n            color: 'white',\n            cursor: 'pointer',\n            fontSize: '12px'\n          },\n          children: [exp === 'neutral' && 'ðŸ˜', exp === 'happy' && 'ðŸ˜Š', exp === 'sad' && 'ðŸ˜¢', exp === 'angry' && 'ðŸ˜ ', exp === 'surprised' && 'ðŸ˜®']\n        }, exp, true, {\n          fileName: _jsxFileName,\n          lineNumber: 883,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 876,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 771,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => {\n        setMode('setup');\n        setFaceData(null);\n      },\n      style: {\n        position: 'absolute',\n        top: 20,\n        right: 20,\n        padding: '10px 20px',\n        background: 'rgba(255,255,255,0.1)',\n        border: '2px solid rgba(255,255,255,0.2)',\n        borderRadius: '25px',\n        color: 'white',\n        cursor: 'pointer'\n      },\n      children: \"\\uD83D\\uDCF8 Qu\\xE9t l\\u1EA1i khu\\xF4n m\\u1EB7t\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 907,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 767,\n    columnNumber: 5\n  }, this);\n};\n_s(Avatar3D, \"Xw1UIHgVI3husRzkpB7G3bLBcg0=\");\n_c = Avatar3D;\nexport default Avatar3D;\nvar _c;\n$RefreshReg$(_c, \"Avatar3D\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","THREE","axios","jsxDEV","_jsxDEV","Avatar3D","_s","mountRef","videoRef","canvasRef","sceneRef","rendererRef","headRef","mouthRef","leftEyeRef","rightEyeRef","leftBrowRef","rightBrowRef","faceTextureRef","mode","setMode","message","setMessage","isListening","setIsListening","isSpeaking","setIsSpeaking","faceData","setFaceData","scanProgress","setScanProgress","expression","setExpression","chatHistory","setChatHistory","avatarConfig","setAvatarConfig","skinColor","eyeColor","hairColor","lipColor","faceTexture","faceShape","eyeSize","noseSize","mouthSize","startWebcam","stream","navigator","mediaDevices","getUserMedia","video","width","height","facingMode","current","srcObject","play","error","console","alert","captureFace","canvas","ctx","getContext","videoWidth","videoHeight","translate","scale","drawImage","setTransform","toDataURL","analyzeFace","imageData","Promise","resolve","img","Image","onload","document","createElement","foreheadData","getImageData","leftEyeData","hairData","lipData","getAvgColor","data","r","g","b","i","length","count","Math","round","src","scanFace","captures","setTimeout","capture","push","_videoRef$current","bestCapture","floor","analysis","prev","getTracks","forEach","track","stop","scene","Scene","background","Color","camera","PerspectiveCamera","window","innerWidth","innerHeight","position","z","renderer","WebGLRenderer","antialias","setSize","shadowMap","enabled","type","PCFSoftShadowMap","appendChild","domElement","keyLight","DirectionalLight","set","castShadow","add","fillLight","rimLight","ambient","AmbientLight","headGroup","Group","headGeo","SphereGeometry","headMat","MeshStandardMaterial","color","roughness","metalness","textureLoader","TextureLoader","load","map","head","Mesh","hairGeo","PI","hairMat","hair","y","createEye","x","eyeGroup","socketGeo","socketMat","socket","eyeballGeo","eyeballMat","eyeball","irisGeo","CircleGeometry","irisMat","iris","pupilGeo","pupilMat","pupil","highlightGeo","highlightMat","MeshBasicMaterial","highlight","setScalar","leftEye","rightEye","browGeo","BoxGeometry","browMat","leftBrow","rotation","rightBrow","noseGroup","noseBridgeGeo","CylinderGeometry","noseMat","noseBridge","noseTipGeo","noseTip","mouthGroup","upperLipGeo","TorusGeometry","lipMat","upperLip","lowerLipGeo","lowerLip","mouthInteriorGeo","PlaneGeometry","mouthInteriorMat","side","DoubleSide","mouthInterior","visible","earGeo","earMat","leftEar","rightEar","neckGeo","neckMat","neck","blinkTimer","breathTimer","talkTimer","currentExpression","onMouseMove","e","clientX","clientY","addEventListener","animate","requestAnimationFrame","sin","blinkAmount","max","mouthOpen","abs","children","render","handleResize","aspect","updateProjectionMatrix","removeEventListener","removeChild","startListening","recognition","SpeechRecognition","webkitSpeechRecognition","lang","continuous","onstart","onresult","event","transcript","results","sendMessage","onerror","start","msg","trim","role","content","includes","response","post","text","aiResponse","ai_response","utterance","SpeechSynthesisUtterance","rate","pitch","onend","speechSynthesis","speak","style","display","flexDirection","alignItems","justifyContent","fontFamily","textAlign","padding","borderRadius","backdropFilter","maxWidth","fontSize","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","opacity","gap","flexWrap","onClick","border","cursor","fontWeight","transition","onMouseOver","target","transform","boxShadow","onMouseOut","overflow","ref","autoPlay","playsInline","top","left","pointerEvents","marginTop","disabled","bottom","maxHeight","overflowY","chat","value","onChange","onKeyPress","key","placeholder","flex","outline","exp","right","_c","$RefreshReg$"],"sources":["D:/IZ/AIClone/frontend/src/Avatar3D.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport * as THREE from 'three';\r\nimport axios from 'axios';\r\n\r\nconst Avatar3D = () => {\r\n  const mountRef = useRef(null);\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const sceneRef = useRef(null);\r\n  const rendererRef = useRef(null);\r\n  const headRef = useRef(null);\r\n  const mouthRef = useRef(null);\r\n  const leftEyeRef = useRef(null);\r\n  const rightEyeRef = useRef(null);\r\n  const leftBrowRef = useRef(null);\r\n  const rightBrowRef = useRef(null);\r\n  const faceTextureRef = useRef(null);\r\n\r\n  const [mode, setMode] = useState('setup'); // setup, scanning, avatar\r\n  const [message, setMessage] = useState('');\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [isSpeaking, setIsSpeaking] = useState(false);\r\n  const [faceData, setFaceData] = useState(null);\r\n  const [scanProgress, setScanProgress] = useState(0);\r\n  const [expression, setExpression] = useState('neutral'); // neutral, happy, sad, angry, surprised\r\n  const [chatHistory, setChatHistory] = useState([]);\r\n\r\n  const [avatarConfig, setAvatarConfig] = useState({\r\n    skinColor: '#F5C6A5',\r\n    eyeColor: '#4A3728',\r\n    hairColor: '#2C1810',\r\n    lipColor: '#C4756E',\r\n    faceTexture: null,\r\n    faceShape: 'oval', // oval, round, square, heart\r\n    eyeSize: 1,\r\n    noseSize: 1,\r\n    mouthSize: 1,\r\n  });\r\n\r\n  // Start webcam for face scanning\r\n  const startWebcam = async () => {\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        video: { width: 640, height: 480, facingMode: 'user' }\r\n      });\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = stream;\r\n        videoRef.current.play();\r\n      }\r\n      setMode('scanning');\r\n    } catch (error) {\r\n      console.error('Webcam error:', error);\r\n      alert('âŒ KhÃ´ng thá»ƒ truy cáº­p camera. Vui lÃ²ng cho phÃ©p quyá»n truy cáº­p.');\r\n    }\r\n  };\r\n\r\n  // Capture face from webcam\r\n  const captureFace = useCallback(() => {\r\n    if (!videoRef.current || !canvasRef.current) return null;\r\n\r\n    const canvas = canvasRef.current;\r\n    const video = videoRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    canvas.width = video.videoWidth;\r\n    canvas.height = video.videoHeight;\r\n\r\n    // Flip horizontally for mirror effect\r\n    ctx.translate(canvas.width, 0);\r\n    ctx.scale(-1, 1);\r\n    ctx.drawImage(video, 0, 0);\r\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n    return canvas.toDataURL('image/jpeg', 0.9);\r\n  }, []);\r\n\r\n  // Analyze face colors and features\r\n  const analyzeFace = useCallback((imageData) => {\r\n    return new Promise((resolve) => {\r\n      const img = new Image();\r\n      img.onload = () => {\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n        const ctx = canvas.getContext('2d');\r\n        ctx.drawImage(img, 0, 0);\r\n\r\n        // Sample skin color from forehead area\r\n        const foreheadData = ctx.getImageData(\r\n          img.width * 0.4, img.height * 0.15,\r\n          img.width * 0.2, img.height * 0.1\r\n        );\r\n\r\n        // Sample eye color\r\n        const leftEyeData = ctx.getImageData(\r\n          img.width * 0.3, img.height * 0.35,\r\n          img.width * 0.1, img.height * 0.05\r\n        );\r\n\r\n        // Sample hair color from top\r\n        const hairData = ctx.getImageData(\r\n          img.width * 0.3, img.height * 0.02,\r\n          img.width * 0.4, img.height * 0.08\r\n        );\r\n\r\n        // Sample lip color\r\n        const lipData = ctx.getImageData(\r\n          img.width * 0.4, img.height * 0.65,\r\n          img.width * 0.2, img.height * 0.08\r\n        );\r\n\r\n        const getAvgColor = (data) => {\r\n          let r = 0, g = 0, b = 0;\r\n          for (let i = 0; i < data.data.length; i += 4) {\r\n            r += data.data[i];\r\n            g += data.data[i + 1];\r\n            b += data.data[i + 2];\r\n          }\r\n          const count = data.data.length / 4;\r\n          return `rgb(${Math.round(r/count)},${Math.round(g/count)},${Math.round(b/count)})`;\r\n        };\r\n\r\n        resolve({\r\n          skinColor: getAvgColor(foreheadData),\r\n          eyeColor: getAvgColor(leftEyeData),\r\n          hairColor: getAvgColor(hairData),\r\n          lipColor: getAvgColor(lipData),\r\n          faceTexture: imageData,\r\n        });\r\n      };\r\n      img.src = imageData;\r\n    });\r\n  }, []);\r\n\r\n  // Scan face with progress\r\n  const scanFace = async () => {\r\n    setScanProgress(0);\r\n    const captures = [];\r\n\r\n    // Capture multiple frames for better analysis\r\n    for (let i = 0; i < 5; i++) {\r\n      await new Promise(r => setTimeout(r, 500));\r\n      const capture = captureFace();\r\n      if (capture) captures.push(capture);\r\n      setScanProgress((i + 1) * 20);\r\n    }\r\n\r\n    if (captures.length > 0) {\r\n      // Use the best capture (middle one)\r\n      const bestCapture = captures[Math.floor(captures.length / 2)];\r\n      const analysis = await analyzeFace(bestCapture);\r\n\r\n      setFaceData(analysis);\r\n      setAvatarConfig(prev => ({\r\n        ...prev,\r\n        ...analysis,\r\n      }));\r\n\r\n      // Stop webcam\r\n      if (videoRef.current?.srcObject) {\r\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\r\n      }\r\n\r\n      setScanProgress(100);\r\n      setTimeout(() => setMode('avatar'), 1000);\r\n    }\r\n  };\r\n\r\n  // Initialize 3D Avatar\r\n  useEffect(() => {\r\n    if (mode !== 'avatar' || !mountRef.current) return;\r\n\r\n    // Scene\r\n    const scene = new THREE.Scene();\r\n    scene.background = new THREE.Color(0x1a1a2e);\r\n    sceneRef.current = scene;\r\n\r\n    // Camera\r\n    const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);\r\n    camera.position.z = 4;\r\n\r\n    // Renderer\r\n    const renderer = new THREE.WebGLRenderer({ antialias: true });\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n    mountRef.current.appendChild(renderer.domElement);\r\n    rendererRef.current = renderer;\r\n\r\n    // Lighting\r\n    const keyLight = new THREE.DirectionalLight(0xffffff, 1.2);\r\n    keyLight.position.set(2, 3, 4);\r\n    keyLight.castShadow = true;\r\n    scene.add(keyLight);\r\n\r\n    const fillLight = new THREE.DirectionalLight(0xffffff, 0.4);\r\n    fillLight.position.set(-2, 1, 2);\r\n    scene.add(fillLight);\r\n\r\n    const rimLight = new THREE.DirectionalLight(0xff9a56, 0.3);\r\n    rimLight.position.set(0, 2, -3);\r\n    scene.add(rimLight);\r\n\r\n    const ambient = new THREE.AmbientLight(0xffffff, 0.5);\r\n    scene.add(ambient);\r\n\r\n    // Create realistic head\r\n    const headGroup = new THREE.Group();\r\n    scene.add(headGroup);\r\n    headRef.current = headGroup;\r\n\r\n    // Head base (ellipsoid)\r\n    const headGeo = new THREE.SphereGeometry(1, 64, 64);\r\n    const headMat = new THREE.MeshStandardMaterial({\r\n      color: avatarConfig.skinColor,\r\n      roughness: 0.4,\r\n      metalness: 0.05,\r\n    });\r\n\r\n    // Apply face texture if available\r\n    if (avatarConfig.faceTexture) {\r\n      const textureLoader = new THREE.TextureLoader();\r\n      const faceTexture = textureLoader.load(avatarConfig.faceTexture);\r\n      headMat.map = faceTexture;\r\n      faceTextureRef.current = faceTexture;\r\n    }\r\n\r\n    const head = new THREE.Mesh(headGeo, headMat);\r\n    head.scale.set(1, 1.15, 0.95);\r\n    head.castShadow = true;\r\n    headGroup.add(head);\r\n\r\n    // Hair\r\n    const hairGeo = new THREE.SphereGeometry(1.12, 64, 64, 0, Math.PI * 2, 0, Math.PI * 0.55);\r\n    const hairMat = new THREE.MeshStandardMaterial({\r\n      color: avatarConfig.hairColor,\r\n      roughness: 0.7,\r\n    });\r\n    const hair = new THREE.Mesh(hairGeo, hairMat);\r\n    hair.position.y = 0.35;\r\n    hair.scale.set(1, 1.1, 0.95);\r\n    headGroup.add(hair);\r\n\r\n    // Eyes with realistic structure\r\n    const createEye = (x) => {\r\n      const eyeGroup = new THREE.Group();\r\n\r\n      // Eye socket (slight indent)\r\n      const socketGeo = new THREE.SphereGeometry(0.22, 32, 32);\r\n      const socketMat = new THREE.MeshStandardMaterial({\r\n        color: '#E8D4C4',\r\n        roughness: 0.5,\r\n      });\r\n      const socket = new THREE.Mesh(socketGeo, socketMat);\r\n      socket.position.z = -0.02;\r\n      eyeGroup.add(socket);\r\n\r\n      // Eyeball (white)\r\n      const eyeballGeo = new THREE.SphereGeometry(0.18, 32, 32);\r\n      const eyeballMat = new THREE.MeshStandardMaterial({\r\n        color: 0xffffff,\r\n        roughness: 0.1,\r\n      });\r\n      const eyeball = new THREE.Mesh(eyeballGeo, eyeballMat);\r\n      eyeGroup.add(eyeball);\r\n\r\n      // Iris\r\n      const irisGeo = new THREE.CircleGeometry(0.1, 32);\r\n      const irisMat = new THREE.MeshStandardMaterial({\r\n        color: avatarConfig.eyeColor,\r\n        roughness: 0.3,\r\n      });\r\n      const iris = new THREE.Mesh(irisGeo, irisMat);\r\n      iris.position.z = 0.16;\r\n      eyeGroup.add(iris);\r\n\r\n      // Pupil\r\n      const pupilGeo = new THREE.CircleGeometry(0.04, 32);\r\n      const pupilMat = new THREE.MeshStandardMaterial({ color: 0x000000 });\r\n      const pupil = new THREE.Mesh(pupilGeo, pupilMat);\r\n      pupil.position.z = 0.17;\r\n      eyeGroup.add(pupil);\r\n\r\n      // Eye highlight\r\n      const highlightGeo = new THREE.CircleGeometry(0.02, 16);\r\n      const highlightMat = new THREE.MeshBasicMaterial({ color: 0xffffff });\r\n      const highlight = new THREE.Mesh(highlightGeo, highlightMat);\r\n      highlight.position.set(0.03, 0.03, 0.18);\r\n      eyeGroup.add(highlight);\r\n\r\n      eyeGroup.position.set(x, 0.25, 0.85);\r\n      eyeGroup.scale.setScalar(avatarConfig.eyeSize);\r\n      return eyeGroup;\r\n    };\r\n\r\n    const leftEye = createEye(-0.32);\r\n    const rightEye = createEye(0.32);\r\n    headGroup.add(leftEye);\r\n    headGroup.add(rightEye);\r\n    leftEyeRef.current = leftEye;\r\n    rightEyeRef.current = rightEye;\r\n\r\n    // Eyebrows\r\n    const browGeo = new THREE.BoxGeometry(0.28, 0.06, 0.08);\r\n    const browMat = new THREE.MeshStandardMaterial({\r\n      color: avatarConfig.hairColor,\r\n      roughness: 0.6,\r\n    });\r\n\r\n    const leftBrow = new THREE.Mesh(browGeo, browMat);\r\n    leftBrow.position.set(-0.32, 0.48, 0.82);\r\n    leftBrow.rotation.z = 0.15;\r\n    headGroup.add(leftBrow);\r\n    leftBrowRef.current = leftBrow;\r\n\r\n    const rightBrow = new THREE.Mesh(browGeo, browMat);\r\n    rightBrow.position.set(0.32, 0.48, 0.82);\r\n    rightBrow.rotation.z = -0.15;\r\n    headGroup.add(rightBrow);\r\n    rightBrowRef.current = rightBrow;\r\n\r\n    // Nose\r\n    const noseGroup = new THREE.Group();\r\n    const noseBridgeGeo = new THREE.CylinderGeometry(0.06, 0.08, 0.35, 16);\r\n    const noseMat = new THREE.MeshStandardMaterial({\r\n      color: avatarConfig.skinColor,\r\n      roughness: 0.4,\r\n    });\r\n    const noseBridge = new THREE.Mesh(noseBridgeGeo, noseMat);\r\n    noseBridge.rotation.x = Math.PI * 0.15;\r\n    noseGroup.add(noseBridge);\r\n\r\n    const noseTipGeo = new THREE.SphereGeometry(0.1, 16, 16);\r\n    const noseTip = new THREE.Mesh(noseTipGeo, noseMat);\r\n    noseTip.position.set(0, -0.12, 0.08);\r\n    noseGroup.add(noseTip);\r\n\r\n    noseGroup.position.set(0, 0.05, 0.9);\r\n    noseGroup.scale.setScalar(avatarConfig.noseSize);\r\n    headGroup.add(noseGroup);\r\n\r\n    // Mouth with lips\r\n    const mouthGroup = new THREE.Group();\r\n\r\n    // Upper lip\r\n    const upperLipGeo = new THREE.TorusGeometry(0.18, 0.04, 8, 32, Math.PI);\r\n    const lipMat = new THREE.MeshStandardMaterial({\r\n      color: avatarConfig.lipColor,\r\n      roughness: 0.5,\r\n    });\r\n    const upperLip = new THREE.Mesh(upperLipGeo, lipMat);\r\n    upperLip.rotation.x = Math.PI;\r\n    upperLip.position.y = 0.02;\r\n    mouthGroup.add(upperLip);\r\n\r\n    // Lower lip\r\n    const lowerLipGeo = new THREE.TorusGeometry(0.16, 0.05, 8, 32, Math.PI);\r\n    const lowerLip = new THREE.Mesh(lowerLipGeo, lipMat);\r\n    lowerLip.position.y = -0.02;\r\n    mouthGroup.add(lowerLip);\r\n\r\n    // Mouth interior (for opening)\r\n    const mouthInteriorGeo = new THREE.PlaneGeometry(0.3, 0.15);\r\n    const mouthInteriorMat = new THREE.MeshStandardMaterial({\r\n      color: 0x3d1f1f,\r\n      side: THREE.DoubleSide,\r\n    });\r\n    const mouthInterior = new THREE.Mesh(mouthInteriorGeo, mouthInteriorMat);\r\n    mouthInterior.position.z = -0.02;\r\n    mouthInterior.visible = false;\r\n    mouthGroup.add(mouthInterior);\r\n\r\n    mouthGroup.position.set(0, -0.38, 0.88);\r\n    mouthGroup.scale.setScalar(avatarConfig.mouthSize);\r\n    headGroup.add(mouthGroup);\r\n    mouthRef.current = mouthGroup;\r\n\r\n    // Ears\r\n    const earGeo = new THREE.SphereGeometry(0.15, 16, 16);\r\n    const earMat = new THREE.MeshStandardMaterial({\r\n      color: avatarConfig.skinColor,\r\n      roughness: 0.5,\r\n    });\r\n\r\n    const leftEar = new THREE.Mesh(earGeo, earMat);\r\n    leftEar.position.set(-0.98, 0.15, 0);\r\n    leftEar.scale.set(0.5, 1, 0.6);\r\n    headGroup.add(leftEar);\r\n\r\n    const rightEar = new THREE.Mesh(earGeo, earMat);\r\n    rightEar.position.set(0.98, 0.15, 0);\r\n    rightEar.scale.set(0.5, 1, 0.6);\r\n    headGroup.add(rightEar);\r\n\r\n    // Neck\r\n    const neckGeo = new THREE.CylinderGeometry(0.35, 0.4, 0.5, 32);\r\n    const neckMat = new THREE.MeshStandardMaterial({\r\n      color: avatarConfig.skinColor,\r\n      roughness: 0.4,\r\n    });\r\n    const neck = new THREE.Mesh(neckGeo, neckMat);\r\n    neck.position.y = -1.35;\r\n    headGroup.add(neck);\r\n\r\n    // Animation variables\r\n    let blinkTimer = 0;\r\n    let breathTimer = 0;\r\n    let talkTimer = 0;\r\n    let currentExpression = 'neutral';\r\n\r\n    // Mouse tracking\r\n    const onMouseMove = (e) => {\r\n      const x = (e.clientX / window.innerWidth) * 2 - 1;\r\n      const y = -(e.clientY / window.innerHeight) * 2 + 1;\r\n\r\n      if (headRef.current) {\r\n        // Smooth head rotation\r\n        headRef.current.rotation.y += (x * 0.4 - headRef.current.rotation.y) * 0.1;\r\n        headRef.current.rotation.x += (y * 0.2 - headRef.current.rotation.x) * 0.1;\r\n      }\r\n\r\n      // Eye follow\r\n      if (leftEyeRef.current && rightEyeRef.current) {\r\n        leftEyeRef.current.rotation.y = x * 0.3;\r\n        leftEyeRef.current.rotation.x = -y * 0.2;\r\n        rightEyeRef.current.rotation.y = x * 0.3;\r\n        rightEyeRef.current.rotation.x = -y * 0.2;\r\n      }\r\n    };\r\n\r\n    window.addEventListener('mousemove', onMouseMove);\r\n\r\n    // Animation loop\r\n    const animate = () => {\r\n      requestAnimationFrame(animate);\r\n\r\n      // Breathing animation\r\n      breathTimer += 0.02;\r\n      if (headRef.current) {\r\n        headRef.current.position.y = Math.sin(breathTimer) * 0.02;\r\n        headRef.current.scale.x = 1 + Math.sin(breathTimer) * 0.005;\r\n      }\r\n\r\n      // Blinking\r\n      blinkTimer++;\r\n      if (blinkTimer > 180 && blinkTimer < 190) {\r\n        const blinkAmount = 1 - Math.sin((blinkTimer - 180) / 10 * Math.PI);\r\n        if (leftEyeRef.current) leftEyeRef.current.scale.y = Math.max(0.1, blinkAmount);\r\n        if (rightEyeRef.current) rightEyeRef.current.scale.y = Math.max(0.1, blinkAmount);\r\n      } else {\r\n        if (leftEyeRef.current) leftEyeRef.current.scale.y = 1;\r\n        if (rightEyeRef.current) rightEyeRef.current.scale.y = 1;\r\n        if (blinkTimer > 190) blinkTimer = 0;\r\n      }\r\n\r\n      // Talking animation (mouth movement)\r\n      if (isSpeaking && mouthRef.current) {\r\n        talkTimer += 0.3;\r\n        const mouthOpen = Math.abs(Math.sin(talkTimer)) * 0.3;\r\n        mouthRef.current.scale.y = 1 + mouthOpen;\r\n        mouthRef.current.children[2].visible = mouthOpen > 0.1; // Show interior when open\r\n      } else {\r\n        if (mouthRef.current) {\r\n          mouthRef.current.scale.y = 1;\r\n          mouthRef.current.children[2].visible = false;\r\n        }\r\n      }\r\n\r\n      // Expression animations\r\n      if (leftBrowRef.current && rightBrowRef.current) {\r\n        switch (expression) {\r\n          case 'happy':\r\n            leftBrowRef.current.position.y = 0.52;\r\n            rightBrowRef.current.position.y = 0.52;\r\n            if (mouthRef.current) mouthRef.current.rotation.z = 0.1;\r\n            break;\r\n          case 'sad':\r\n            leftBrowRef.current.rotation.z = -0.3;\r\n            rightBrowRef.current.rotation.z = 0.3;\r\n            if (mouthRef.current) mouthRef.current.rotation.z = -0.1;\r\n            break;\r\n          case 'angry':\r\n            leftBrowRef.current.rotation.z = 0.4;\r\n            rightBrowRef.current.rotation.z = -0.4;\r\n            leftBrowRef.current.position.y = 0.42;\r\n            rightBrowRef.current.position.y = 0.42;\r\n            break;\r\n          case 'surprised':\r\n            leftBrowRef.current.position.y = 0.55;\r\n            rightBrowRef.current.position.y = 0.55;\r\n            if (mouthRef.current) mouthRef.current.scale.y = 1.5;\r\n            break;\r\n          default:\r\n            leftBrowRef.current.position.y = 0.48;\r\n            rightBrowRef.current.position.y = 0.48;\r\n            leftBrowRef.current.rotation.z = 0.15;\r\n            rightBrowRef.current.rotation.z = -0.15;\r\n        }\r\n      }\r\n\r\n      renderer.render(scene, camera);\r\n    };\r\n\r\n    animate();\r\n\r\n    // Resize handler\r\n    const handleResize = () => {\r\n      camera.aspect = window.innerWidth / window.innerHeight;\r\n      camera.updateProjectionMatrix();\r\n      renderer.setSize(window.innerWidth, window.innerHeight);\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('mousemove', onMouseMove);\r\n      window.removeEventListener('resize', handleResize);\r\n      if (mountRef.current && renderer.domElement) {\r\n        mountRef.current.removeChild(renderer.domElement);\r\n      }\r\n    };\r\n  }, [mode, avatarConfig, isSpeaking, expression]);\r\n\r\n  // Voice recognition\r\n  const startListening = () => {\r\n    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();\r\n    recognition.lang = 'vi-VN';\r\n    recognition.continuous = false;\r\n\r\n    recognition.onstart = () => setIsListening(true);\r\n\r\n    recognition.onresult = (event) => {\r\n      const transcript = event.results[0][0].transcript;\r\n      setMessage(transcript);\r\n      setIsListening(false);\r\n      sendMessage(transcript);\r\n    };\r\n\r\n    recognition.onerror = () => setIsListening(false);\r\n    recognition.start();\r\n  };\r\n\r\n  // Send message to AI\r\n  const sendMessage = async (msg) => {\r\n    if (!msg.trim()) return;\r\n\r\n    setChatHistory(prev => [...prev, { role: 'user', content: msg }]);\r\n    setIsSpeaking(true);\r\n\r\n    // Detect emotion from message\r\n    if (msg.includes('vui') || msg.includes('haha') || msg.includes('ðŸ˜Š')) {\r\n      setExpression('happy');\r\n    } else if (msg.includes('buá»“n') || msg.includes('ðŸ˜¢')) {\r\n      setExpression('sad');\r\n    } else if (msg.includes('tá»©c') || msg.includes('ðŸ˜ ')) {\r\n      setExpression('angry');\r\n    } else {\r\n      setExpression('neutral');\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post('http://localhost:8000/api/chat', { text: msg });\r\n      const aiResponse = response.data.ai_response;\r\n\r\n      setChatHistory(prev => [...prev, { role: 'ai', content: aiResponse }]);\r\n      setMessage(aiResponse);\r\n\r\n      // Text-to-speech with emotion\r\n      const utterance = new SpeechSynthesisUtterance(aiResponse);\r\n      utterance.lang = 'vi-VN';\r\n      utterance.rate = 1.0;\r\n      utterance.pitch = 1.0;\r\n\r\n      utterance.onend = () => {\r\n        setIsSpeaking(false);\r\n        setExpression('neutral');\r\n      };\r\n\r\n      window.speechSynthesis.speak(utterance);\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      setIsSpeaking(false);\r\n      setExpression('neutral');\r\n    }\r\n  };\r\n\r\n  // Render based on mode\r\n  if (mode === 'setup') {\r\n    return (\r\n      <div style={{\r\n        width: '100%',\r\n        height: '100vh',\r\n        background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        color: 'white',\r\n        fontFamily: \"'Segoe UI', sans-serif\",\r\n      }}>\r\n        <div style={{\r\n          textAlign: 'center',\r\n          padding: '40px',\r\n          background: 'rgba(255,255,255,0.1)',\r\n          borderRadius: '20px',\r\n          backdropFilter: 'blur(10px)',\r\n          maxWidth: '500px',\r\n        }}>\r\n          <h1 style={{ fontSize: '2.5rem', marginBottom: '20px' }}>\r\n            ðŸŽ­ AI Clone Creator\r\n          </h1>\r\n          <p style={{ fontSize: '1.2rem', opacity: 0.8, marginBottom: '30px' }}>\r\n            Táº¡o nhÃ¢n báº£n AI cá»§a chÃ­nh báº¡n vá»›i khuÃ´n máº·t, giá»ng nÃ³i vÃ  tÃ­nh cÃ¡ch giá»‘ng há»‡t báº¡n\r\n          </p>\r\n\r\n          <div style={{ marginBottom: '30px' }}>\r\n            <div style={{ display: 'flex', gap: '15px', justifyContent: 'center', flexWrap: 'wrap' }}>\r\n              <div style={{ padding: '15px', background: 'rgba(255,154,86,0.2)', borderRadius: '10px' }}>\r\n                ðŸ“¸ QuÃ©t khuÃ´n máº·t\r\n              </div>\r\n              <div style={{ padding: '15px', background: 'rgba(255,154,86,0.2)', borderRadius: '10px' }}>\r\n                ðŸŽ¨ Táº¡o 3D Avatar\r\n              </div>\r\n              <div style={{ padding: '15px', background: 'rgba(255,154,86,0.2)', borderRadius: '10px' }}>\r\n                ðŸ—£ï¸ NÃ³i chuyá»‡n AI\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            onClick={startWebcam}\r\n            style={{\r\n              padding: '15px 40px',\r\n              fontSize: '1.2rem',\r\n              background: 'linear-gradient(135deg, #ff9a56 0%, #ff7043 100%)',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '30px',\r\n              cursor: 'pointer',\r\n              fontWeight: 'bold',\r\n              transition: 'transform 0.2s, box-shadow 0.2s',\r\n            }}\r\n            onMouseOver={(e) => {\r\n              e.target.style.transform = 'scale(1.05)';\r\n              e.target.style.boxShadow = '0 10px 30px rgba(255,112,67,0.4)';\r\n            }}\r\n            onMouseOut={(e) => {\r\n              e.target.style.transform = 'scale(1)';\r\n              e.target.style.boxShadow = 'none';\r\n            }}\r\n          >\r\n            ðŸš€ Báº¯t Ä‘áº§u táº¡o Clone\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (mode === 'scanning') {\r\n    return (\r\n      <div style={{\r\n        width: '100%',\r\n        height: '100vh',\r\n        background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)',\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        color: 'white',\r\n      }}>\r\n        <h2 style={{ marginBottom: '20px' }}>ðŸ“¸ QuÃ©t khuÃ´n máº·t cá»§a báº¡n</h2>\r\n\r\n        <div style={{\r\n          position: 'relative',\r\n          borderRadius: '20px',\r\n          overflow: 'hidden',\r\n          boxShadow: '0 20px 60px rgba(0,0,0,0.5)',\r\n        }}>\r\n          <video\r\n            ref={videoRef}\r\n            style={{\r\n              width: '640px',\r\n              maxWidth: '90vw',\r\n              transform: 'scaleX(-1)',\r\n              borderRadius: '20px',\r\n            }}\r\n            autoPlay\r\n            playsInline\r\n          />\r\n\r\n          {/* Face guide overlay */}\r\n          <div style={{\r\n            position: 'absolute',\r\n            top: '50%',\r\n            left: '50%',\r\n            transform: 'translate(-50%, -50%)',\r\n            width: '250px',\r\n            height: '320px',\r\n            border: '3px dashed rgba(255,154,86,0.8)',\r\n            borderRadius: '50%',\r\n            pointerEvents: 'none',\r\n          }} />\r\n\r\n          <canvas ref={canvasRef} style={{ display: 'none' }} />\r\n        </div>\r\n\r\n        {scanProgress > 0 && scanProgress < 100 && (\r\n          <div style={{ marginTop: '20px', width: '300px' }}>\r\n            <div style={{\r\n              height: '10px',\r\n              background: 'rgba(255,255,255,0.2)',\r\n              borderRadius: '5px',\r\n              overflow: 'hidden',\r\n            }}>\r\n              <div style={{\r\n                height: '100%',\r\n                width: `${scanProgress}%`,\r\n                background: 'linear-gradient(90deg, #ff9a56, #ff7043)',\r\n                transition: 'width 0.3s',\r\n              }} />\r\n            </div>\r\n            <p style={{ textAlign: 'center', marginTop: '10px' }}>\r\n              Äang quÃ©t... {scanProgress}%\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        <div style={{ marginTop: '30px', display: 'flex', gap: '15px' }}>\r\n          <button\r\n            onClick={scanFace}\r\n            disabled={scanProgress > 0 && scanProgress < 100}\r\n            style={{\r\n              padding: '15px 30px',\r\n              fontSize: '1rem',\r\n              background: scanProgress > 0 ? '#ccc' : 'linear-gradient(135deg, #ff9a56 0%, #ff7043 100%)',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '25px',\r\n              cursor: scanProgress > 0 ? 'not-allowed' : 'pointer',\r\n              fontWeight: 'bold',\r\n            }}\r\n          >\r\n            {scanProgress === 100 ? 'âœ… HoÃ n thÃ nh!' : 'ðŸ“· Chá»¥p & QuÃ©t'}\r\n          </button>\r\n\r\n          <button\r\n            onClick={() => setMode('avatar')}\r\n            style={{\r\n              padding: '15px 30px',\r\n              fontSize: '1rem',\r\n              background: 'rgba(255,255,255,0.2)',\r\n              color: 'white',\r\n              border: '2px solid rgba(255,255,255,0.3)',\r\n              borderRadius: '25px',\r\n              cursor: 'pointer',\r\n            }}\r\n          >\r\n            Bá» qua â†’\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Avatar mode\r\n  return (\r\n    <div style={{ width: '100%', height: '100vh', position: 'relative' }}>\r\n      <div ref={mountRef} style={{ width: '100%', height: '100%' }} />\r\n\r\n      {/* Chat Panel */}\r\n      <div style={{\r\n        position: 'absolute',\r\n        bottom: 20,\r\n        left: 20,\r\n        width: '380px',\r\n        maxHeight: '60vh',\r\n        background: 'rgba(26,26,46,0.95)',\r\n        borderRadius: '20px',\r\n        padding: '20px',\r\n        color: 'white',\r\n        backdropFilter: 'blur(10px)',\r\n        boxShadow: '0 10px 40px rgba(0,0,0,0.3)',\r\n      }}>\r\n        <h3 style={{\r\n          color: '#ff9a56',\r\n          marginBottom: '15px',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '10px',\r\n        }}>\r\n          ðŸŽ­ AI Clone cá»§a báº¡n\r\n          {isSpeaking && <span style={{ fontSize: '12px', color: '#4ECDC4' }}>ðŸ”Š Äang nÃ³i...</span>}\r\n        </h3>\r\n\r\n        {/* Chat history */}\r\n        <div style={{\r\n          maxHeight: '200px',\r\n          overflowY: 'auto',\r\n          marginBottom: '15px',\r\n          padding: '10px',\r\n          background: 'rgba(255,255,255,0.05)',\r\n          borderRadius: '10px',\r\n        }}>\r\n          {chatHistory.map((chat, i) => (\r\n            <div key={i} style={{\r\n              marginBottom: '10px',\r\n              textAlign: chat.role === 'user' ? 'right' : 'left',\r\n            }}>\r\n              <span style={{\r\n                display: 'inline-block',\r\n                padding: '8px 12px',\r\n                borderRadius: '15px',\r\n                background: chat.role === 'user' ? '#ff7043' : 'rgba(255,255,255,0.1)',\r\n                maxWidth: '80%',\r\n                fontSize: '14px',\r\n              }}>\r\n                {chat.content}\r\n              </span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Input */}\r\n        <div style={{ display: 'flex', gap: '10px' }}>\r\n          <input\r\n            type=\"text\"\r\n            value={message}\r\n            onChange={(e) => setMessage(e.target.value)}\r\n            onKeyPress={(e) => e.key === 'Enter' && sendMessage(message)}\r\n            placeholder=\"NÃ³i chuyá»‡n vá»›i clone cá»§a báº¡n...\"\r\n            style={{\r\n              flex: 1,\r\n              padding: '12px',\r\n              borderRadius: '25px',\r\n              border: 'none',\r\n              background: 'rgba(255,255,255,0.1)',\r\n              color: 'white',\r\n              outline: 'none',\r\n            }}\r\n          />\r\n          <button\r\n            onClick={startListening}\r\n            disabled={isListening || isSpeaking}\r\n            style={{\r\n              width: '45px',\r\n              height: '45px',\r\n              borderRadius: '50%',\r\n              border: 'none',\r\n              background: isListening ? '#FF6B6B' : '#4ECDC4',\r\n              color: 'white',\r\n              cursor: 'pointer',\r\n              fontSize: '18px',\r\n            }}\r\n          >\r\n            ðŸŽ¤\r\n          </button>\r\n          <button\r\n            onClick={() => sendMessage(message)}\r\n            disabled={isSpeaking}\r\n            style={{\r\n              width: '45px',\r\n              height: '45px',\r\n              borderRadius: '50%',\r\n              border: 'none',\r\n              background: '#ff7043',\r\n              color: 'white',\r\n              cursor: 'pointer',\r\n              fontSize: '18px',\r\n            }}\r\n          >\r\n            ðŸ’¬\r\n          </button>\r\n        </div>\r\n\r\n        {/* Expression buttons */}\r\n        <div style={{\r\n          marginTop: '15px',\r\n          display: 'flex',\r\n          gap: '8px',\r\n          justifyContent: 'center',\r\n        }}>\r\n          {['neutral', 'happy', 'sad', 'angry', 'surprised'].map(exp => (\r\n            <button\r\n              key={exp}\r\n              onClick={() => setExpression(exp)}\r\n              style={{\r\n                padding: '8px 12px',\r\n                borderRadius: '15px',\r\n                border: expression === exp ? '2px solid #ff7043' : '2px solid transparent',\r\n                background: 'rgba(255,255,255,0.1)',\r\n                color: 'white',\r\n                cursor: 'pointer',\r\n                fontSize: '12px',\r\n              }}\r\n            >\r\n              {exp === 'neutral' && 'ðŸ˜'}\r\n              {exp === 'happy' && 'ðŸ˜Š'}\r\n              {exp === 'sad' && 'ðŸ˜¢'}\r\n              {exp === 'angry' && 'ðŸ˜ '}\r\n              {exp === 'surprised' && 'ðŸ˜®'}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Rescan button */}\r\n      <button\r\n        onClick={() => {\r\n          setMode('setup');\r\n          setFaceData(null);\r\n        }}\r\n        style={{\r\n          position: 'absolute',\r\n          top: 20,\r\n          right: 20,\r\n          padding: '10px 20px',\r\n          background: 'rgba(255,255,255,0.1)',\r\n          border: '2px solid rgba(255,255,255,0.2)',\r\n          borderRadius: '25px',\r\n          color: 'white',\r\n          cursor: 'pointer',\r\n        }}\r\n      >\r\n        ðŸ“¸ QuÃ©t láº¡i khuÃ´n máº·t\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Avatar3D;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}